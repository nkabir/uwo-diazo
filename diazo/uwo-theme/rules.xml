<?xml version="1.0" encoding="UTF-8"?>
<rules
    xmlns="http://namespaces.plone.org/diazo"
    xmlns:css="http://namespaces.plone.org/diazo/css"
    xmlns:xsl="http://www.w3.org/1999/XSL/Transform">

    <!-- Apply the following rules to standard Plone pages -->
    <rules css:if-not-content=".userrole-authenticated">

        <rules css:if-content="#visual-portal-wrapper">
            <theme href="index.html" />
        </rules>

        <!-- Head elements -->
        <replace css:theme="html head title" css:content="html head title" />
        <after css:theme-children="html head" css:content="html head base" />
        <after css:theme-children="html head" css:content="html head script" />

        <!-- Logo -->
        <copy attributes="href" css:theme=".wordmark-link" css:content="#portal-logo" />

        <!-- Site Name -->
        <replace css:theme-children=".site-name" css:content-children="#header" />

        <!-- Tabs -->
        <replace css:theme-children=".navigation__site" css:content-children="#portal-globalnav" />

        <!-- Search -->
        <copy attributes="action" css:theme="#searchbox" css:content="#portal-searchbox form" />
        <copy attributes="name" css:theme="#searchbox .search-query" css:content="#portal-searchbox form .searchField" />

        <!-- Copy base tag from Plone -->
        <before css:theme-children="html head" css:content="html head base" />

        <!-- merge classes from Plone body with theme body -->
        <merge attributes="class" css:theme="body" css:content="body" />

        <!-- Copy script tags from Plone head to end of body -->
        <after css:theme-children="html body" css:content="html head script" />

        <!-- Main columns -->
        <replace css:content-children="#content" css:theme-children="#content" />
        <replace css:content-children="#portal-column-one" css:theme-children="#left-column" />
        <replace css:content-children="#portal-column-two" css:theme-children="#right-column" />

    </rules>

</rules>
